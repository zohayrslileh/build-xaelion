"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const ClientError_1=__importDefault(require("./ClientError")),Configs_1=require("#/Configs");class Listener{socket;namespace;constructor(t,e){this.namespace=t,this.socket=e,this.handle=this.handle.bind(this),this.on=this.on.bind(this)}handle(t){return t(Object.assign(this))}on(t,e){const s=()=>this.socket.off(t,r),r=async(...t)=>{try{await e(Object.assign(this,{off:s}),...t)}catch(t){t instanceof ClientError_1.default?this.socket.emit("error",t.message):this.socket.emit("error",Configs_1.DEV_MODE?String(t):"Internal error")}};return this.socket.on(t,r),s}}exports.default=Listener;